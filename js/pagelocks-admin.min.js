class PageLocksAdmin{async readLocks(){let e;try{const t=await fetch(window.location.pathname+"/pagelocks:readLocks",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)return void this.notify("ReadLocks: No valid response from server.","error");e=await t.json()}catch(e){return void this.notify("Readlocks: Unexpected error while accessing the server.","error")}e&&(0===Object.keys(e.locks).length&&this.notify(e.countAlert,"info"),this.displayLocks(e))}displayLocks(e){const t=document.getElementById("locklist");t.innerHTML="",Object.keys(e.locks).forEach((o,n)=>{const s=e.locks[o],c=new Date(1e3*s.timestamp),a=document.createElement("tr");a.innerHTML=`\n            <td class="author">${s.email}</td>\n            <td class="route">${o}</td>\n            <td class="since">${c.toLocaleTimeString()}</td>\n            <td id="row${n}" class="delete">\n                <a href="#delete" \n                    class="page-delete delete-action" \n                    title="Delete Item"\n                    >\n                    <i class="fa fa-close"></i>\n                </a>\n            </td>\n            `,t.appendChild(a);document.getElementById("row"+n).addEventListener("click",()=>{window.confirm(e.alert.replace("%s",s.fullname))&&this.removeLock(o)})})}async removeLock(e){let t;try{const o={url:e};t=await fetch(window.location.pathname+"/pagelocks:forceRemoveLock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})}catch(e){return void this.notify("RemoveLock: Unexpected error while accessing the server.","error")}if(this.clearAlerts(),t.ok){const e=await t.json();e.isLockRemoved?this.notify(e.alert,"info"):this.notify(e.alert,"error"),this.readLocks()}else this.notify("No valid response from server.","error")}notify(e,t){const o=document.createElement("div");o.className=t+" alert pagelocks";const n=document.createTextNode(e);o.appendChild(n);const s=document.getElementById("messages");null==s||s.appendChild(o)}clearAlerts(){const e=document.getElementsByClassName("alert pagelocks");for(const t of e){const e=document.getElementById("messages");null==e||e.removeChild(t)}}}if("GravAdmin"in window){const e=new PageLocksAdmin;e.clearAlerts(),(async()=>{await e.readLocks()})()}export{};